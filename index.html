<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ùêåùêÄùêàùêã ùêíùêìùêéùêëùêÑ</title>

    <!-- Telegram Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f8f8;
            color: #333333;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        /* Allow text selection in inputs */
        input, textarea, .selectable-text { user-select: text; -webkit-user-select: text; }

        /* Custom Card Style */
        .card-bg {
            background-color: #ffffff;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            transition: all 0.2s ease;
        }
        .card-bg:active { transform: scale(0.98); }

        /* Buttons & Gradients */
        .btn-gradient {
            background-image: linear-gradient(to right, #007bff, #0056b3);
            color: white; font-weight: 600;
            transition: transform 0.1s;
        }
        .btn-gradient:active { transform: scale(0.95); }
        
        .text-accent-gradient {
            background: linear-gradient(to right, #007bff, #0056b3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Input Fields */
        .input-field {
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #1f2937;
            padding: 12px;
            border-radius: 8px;
            width: 100%;
            outline: none;
        }
        .input-field:focus { border-color: #007bff; ring: 2px; }

        /* Page Transitions */
        .sub-page { display: none; animation: fadeIn 0.3s ease-in-out; }
        .sub-page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Header Styles */
        .header-native {
            background-color: #007bff;
            padding: 10px 12px;
            position: sticky; top: 0; z-index: 40;
            display: flex; align-items: center; justify-content: space-between;
            color: white; gap: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header-icon-btn {
            background: rgba(255,255,255,0.2);
            padding: 6px; border-radius: 8px;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
        }

        /* Bottom Nav */
        .bottom-nav {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(8px);
            border-top: 1px solid #e5e7eb;
            position: fixed; bottom: 0; left: 0; right: 0;
            display: flex; justify-content: space-around;
            padding: 8px 0; height: 65px; z-index: 50;
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center;
            font-size: 10px; font-weight: 600; color: #6b7280;
            gap: 2px; width: 60px;
        }
        .nav-item.active { color: #007bff; }
        
        /* Loading Spinner */
        .spinner {
            width: 40px; height: 40px; border-radius: 50%;
            background: conic-gradient(#0000 10%, #007bff);
            -webkit-mask: radial-gradient(farthest-side, #0000 calc(100% - 8px), #000 0);
            animation: spin 1s infinite linear;
        }
        @keyframes spin { to { transform: rotate(1turn); } }

        #loader { position: fixed; inset: 0; background: #f8f8f8; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        /* Banner Slider */
        .banner-container { overflow: hidden; border-radius: 12px; position: relative; aspect-ratio: 16/9; }
        .banner-wrapper { display: flex; transition: transform 0.5s ease; height: 100%; }
        .banner-slide { min-width: 100%; height: 100%; }
        .banner-slide img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body class="max-w-md mx-auto bg-gray-50 min-h-screen pb-20">

    <!-- Global Loader -->
    <div id="loader">
        <div class="spinner mb-4"></div>
        <h1 class="text-xl font-bold text-blue-600">MAIL STORE</h1>
        <p class="text-xs text-gray-500 mt-2">Loading data...</p>
    </div>

    <!-- Header: Profile | + | Balance | Notification | Menu | ? -->
    <header class="header-native" id="main-header">
        <!-- 1. Profile -->
        <div onclick="navigateTo('profile-page')" class="flex items-center gap-2 cursor-pointer bg-white/10 px-2 py-1 rounded-full">
            <img id="header-pic" src="" class="w-7 h-7 rounded-full border border-white hidden object-cover">
            <div id="header-initials" class="w-7 h-7 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center font-bold text-xs hidden"></div>
            <span class="text-xs font-bold truncate max-w-[60px]" id="header-name">User</span>
        </div>

        <!-- 2. Deposit (+) -->
        <button onclick="navigateTo('pay-page')" class="header-icon-btn" title="Deposit">
            <i data-lucide="plus" class="w-5 h-5"></i>
        </button>

        <!-- 3. Balance (Withdraw) -->
        <div onclick="navigateTo('withdraw-page')" class="bg-white/20 px-3 py-1.5 rounded-full flex items-center gap-1 cursor-pointer" title="Click to Withdraw">
            <i data-lucide="circle-dollar-sign" class="w-4 h-4 text-yellow-300"></i>
            <span id="header-balance" class="font-bold text-sm">0.00</span>
        </div>

        <!-- 4. Notification -->
        <div class="relative">
            <button onclick="openNotifications()" class="header-icon-btn">
                <i data-lucide="bell" class="w-5 h-5"></i>
            </button>
            <span id="notif-badge" class="absolute top-0 right-0 w-2.5 h-2.5 bg-red-500 border-2 border-blue-500 rounded-full hidden"></span>
        </div>

        <!-- 5. Menu (Support) -->
        <button onclick="openSupport()" class="header-icon-btn" title="Support Menu">
            <i data-lucide="layout-grid" class="w-5 h-5"></i>
        </button>

        <!-- 6. Help (?) -->
        <button onclick="openHelpModal()" class="header-icon-btn" title="Help">
            <i data-lucide="help-circle" class="w-5 h-5"></i>
        </button>
    </header>

    <!-- Main Content Area -->
    <main class="p-2">

        <!-- HOME PAGE -->
        <div id="home-page" class="sub-page active space-y-4">
            <div class="banner-container shadow-md">
                <div class="banner-wrapper" id="banner-slider">
                    <div class="banner-slide"><img src="https://i.postimg.cc/zBp8rCX9/Yellow-Orange-Modern-Marketing-Courses-You-Tube-Thumbnail-20250910-185659-0000.png"></div>
                    <div class="banner-slide"><img src="https://i.postimg.cc/W1syFD8p/Grey-Blue-Illustration-Refer-a-Friend-Instagram-Post-1080-x-720-px-20250917-223749-0000.png"></div>
                    <div class="banner-slide"><img src="https://i.postimg.cc/52HsFwvV/Black-and-Orange-Money-You-Tube-Thumbnail-20250917-224706-0000.png"></div>
                </div>
            </div>

            <div class="card-bg p-5 rounded-xl bg-white flex items-center justify-between">
                <div>
                    <p class="text-gray-500 text-xs font-medium">CURRENT BALANCE</p>
                    <h2 class="text-3xl font-bold text-gray-800 mt-1" id="home-balance-display">‡ß≥0.00</h2>
                </div>
                <button onclick="navigateTo('pay-page')" class="btn-gradient px-5 py-2 rounded-lg shadow-lg text-sm">Add Money</button>
            </div>
        </div>

        <!-- EARN PAGE (Naval, Insta, Manual) -->
        <div id="earn-page" class="sub-page space-y-4">
            <h2 class="text-xl font-bold text-center text-gray-800 mb-2">Choose Earning Method</h2>

            <!-- Naval Coin -->
            <div onclick="navigateTo('naval-page')" class="card-bg p-4 rounded-xl flex items-center justify-between cursor-pointer">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center text-yellow-600">
                        <i data-lucide="coins" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg">Naval Coin</h3>
                        <p class="text-xs text-gray-500">Sell your coins & earn</p>
                    </div>
                </div>
                <i data-lucide="chevron-right" class="text-gray-400"></i>
            </div>

            <!-- Instagram -->
            <div onclick="navigateTo('insta-page')" class="card-bg p-4 rounded-xl flex items-center justify-between cursor-pointer">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center text-pink-600">
                        <i data-lucide="instagram" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg">Instagram</h3>
                        <p class="text-xs text-gray-500">Complete tasks & earn</p>
                    </div>
                </div>
                <i data-lucide="chevron-right" class="text-gray-400"></i>
            </div>

            <!-- Manual Earn -->
            <div onclick="handleManualEarn()" class="card-bg p-4 rounded-xl flex items-center justify-between cursor-pointer">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-green-600">
                        <i data-lucide="hand-coins" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg">Manual Earn</h3>
                        <p class="text-xs text-gray-500">Daily tasks</p>
                    </div>
                </div>
                <button class="bg-gray-200 text-xs px-2 py-1 rounded font-bold">Start</button>
            </div>
        </div>

        <!-- NAVAL COIN SUB-PAGE -->
        <div id="naval-page" class="sub-page space-y-4">
            <div class="flex items-center gap-2 mb-4">
                <button onclick="navigateTo('earn-page')" class="p-2 bg-white rounded-full shadow"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="text-xl font-bold">Sell Naval Coin</h2>
            </div>
            <div class="card-bg p-5 rounded-xl space-y-4">
                <div class="bg-yellow-50 border border-yellow-100 p-3 rounded text-sm text-yellow-800">
                    ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶Ø‡¶º‡ßá‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®‡ßá‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ü‡¶á‡¶°‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®‡•§ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶¨‡ßá‡¶®‡•§
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-600">Coin Amount</label>
                    <input id="naval-amount" type="number" class="input-field mt-1" placeholder="Ex: 1000">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-600">Proof / Transaction Link</label>
                    <textarea id="naval-proof" rows="3" class="input-field mt-1" placeholder="Paste transaction link or details..."></textarea>
                </div>
                <button onclick="submitEarnRequest('Naval Coin', 'naval-amount', 'naval-proof')" class="btn-gradient w-full py-3 rounded-lg shadow-lg">Submit for Review</button>
            </div>
        </div>

        <!-- INSTAGRAM SUB-PAGE -->
        <div id="insta-page" class="sub-page space-y-4">
            <div class="flex items-center gap-2 mb-4">
                <button onclick="navigateTo('earn-page')" class="p-2 bg-white rounded-full shadow"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="text-xl font-bold">Instagram Task</h2>
            </div>
            <div class="card-bg p-5 rounded-xl space-y-4">
                <div class="bg-pink-50 border border-pink-100 p-3 rounded text-sm text-pink-800">
                    ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßá ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¨‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®‡•§
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-600">Task Type</label>
                    <input id="insta-type" type="text" class="input-field mt-1" placeholder="Ex: Like/Follow">
                </div>
                <div>
                    <label class="text-xs font-bold text-gray-600">Proof / Link</label>
                    <textarea id="insta-proof" rows="3" class="input-field mt-1" placeholder="Paste screenshot link or username..."></textarea>
                </div>
                <button onclick="submitEarnRequest('Instagram', 'insta-type', 'insta-proof')" class="btn-gradient w-full py-3 rounded-lg shadow-lg">Submit for Review</button>
            </div>
        </div>

        <!-- BUY PAGE (OTP Only) -->
        <div id="buy-page" class="sub-page space-y-4">
            <h2 class="text-xl font-bold text-center">Buy OTP Mail</h2>
            <div id="products-container" class="space-y-3 min-h-[100px] pb-10">
                <!-- Mails loaded by JS -->
            </div>
            <div class="mt-6 pt-4 border-t">
                <h3 class="font-bold mb-2">Purchase History</h3>
                <div id="purchase-history-list" class="space-y-2 text-sm"></div>
            </div>
        </div>

        <!-- DEPOSIT PAGE -->
        <div id="pay-page" class="sub-page space-y-4">
            <h2 class="text-xl font-bold text-center">Add Balance</h2>
            
            <div class="grid grid-cols-2 gap-3">
                <div class="bg-white p-3 rounded border text-center">
                    <img src="https://i.postimg.cc/Jh9s6jWw/20250922-113350.png" class="w-8 h-8 mx-auto mb-1">
                    <p class="font-bold text-xs">Nagad (Send Money)</p>
                    <p class="font-mono text-sm bg-gray-100 rounded my-1 select-all">01864260513</p>
                    <button onclick="copyText('01864260513')" class="text-xs text-blue-600">Copy</button>
                </div>
                <div class="bg-white p-3 rounded border text-center">
                    <img src="https://i.postimg.cc/tCwGVkdH/20250922-113514.png" class="w-8 h-8 mx-auto mb-1">
                    <p class="font-bold text-xs">bKash (Send Money)</p>
                    <p class="font-mono text-sm bg-gray-100 rounded my-1 select-all">01827750260</p>
                    <button onclick="copyText('01827750260')" class="text-xs text-blue-600">Copy</button>
                </div>
            </div>

            <div class="card-bg p-4 rounded-xl space-y-3">
                <h3 class="font-bold text-sm">Deposit Form</h3>
                <select id="dep-method" class="input-field"><option value="Nagad">Nagad</option><option value="bKash">bKash</option><option value="Rocket">Rocket</option></select>
                <input id="dep-amount" type="number" placeholder="Amount (BDT)" class="input-field">
                <input id="dep-number" type="text" placeholder="Sender Number" class="input-field">
                <input id="dep-trx" type="text" placeholder="Transaction ID" class="input-field">
                <button onclick="submitDeposit()" class="btn-gradient w-full py-3 rounded-lg">Submit Request</button>
            </div>
            <div id="deposit-history" class="space-y-2 mt-4"></div>
        </div>

        <!-- WITHDRAW PAGE -->
        <div id="withdraw-page" class="sub-page space-y-4">
            <div class="flex items-center gap-2 mb-2">
                <button onclick="navigateTo('home-page')" class="p-2 bg-white rounded-full shadow"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                <h2 class="text-xl font-bold">Withdraw Money</h2>
            </div>
            <div class="card-bg p-4 rounded-xl space-y-3">
                <select id="with-method" class="input-field"><option value="Nagad">Nagad</option><option value="bKash">bKash</option></select>
                <input id="with-number" type="text" placeholder="Your Number" class="input-field">
                <input id="with-amount" type="number" placeholder="Amount (Min 100)" class="input-field">
                <button onclick="submitWithdraw()" class="btn-gradient w-full py-3 rounded-lg">Withdraw</button>
            </div>
            <div id="withdraw-history" class="space-y-2 mt-4"></div>
        </div>

        <!-- PROFILE PAGE -->
        <div id="profile-page" class="sub-page space-y-4">
            <div class="card-bg p-6 rounded-xl flex flex-col items-center text-center bg-white">
                <img id="p-pic" src="" class="w-20 h-20 rounded-full border-2 border-blue-500 mb-2 hidden object-cover">
                <div id="p-initials" class="w-20 h-20 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-2xl font-bold mb-2 hidden"></div>
                <h2 id="p-name" class="text-xl font-bold">User Name</h2>
                <p id="p-id" class="text-gray-500 text-sm">ID: 12345</p>
            </div>

            <div class="space-y-2">
                <div onclick="navigateTo('link-team-page')" class="card-bg p-3 rounded-lg flex justify-between cursor-pointer">
                    <span>üë• Team Link</span> <i data-lucide="chevron-right" class="w-5 h-5 text-gray-400"></i>
                </div>
                <div onclick="navigateTo('send-page')" class="card-bg p-3 rounded-lg flex justify-between cursor-pointer">
                    <span>üí∏ Send Balance</span> <i data-lucide="chevron-right" class="w-5 h-5 text-gray-400"></i>
                </div>
                <div onclick="openSupport()" class="card-bg p-3 rounded-lg flex justify-between cursor-pointer">
                    <span>üéß Support</span> <i data-lucide="chevron-right" class="w-5 h-5 text-gray-400"></i>
                </div>
            </div>
        </div>

        <!-- LINK TEAM PAGE -->
        <div id="link-team-page" class="sub-page space-y-4">
            <div class="flex items-center gap-2">
                <button onclick="navigateTo('profile-page')" class="p-2 bg-white rounded-full"><i data-lucide="arrow-left"></i></button>
                <h2 class="font-bold">My Team</h2>
            </div>
            <div class="card-bg p-4 rounded-xl space-y-3">
                <p class="text-xs text-gray-500">Add friend by ID (They can use your balance)</p>
                <div class="flex gap-2">
                    <input id="team-friend-id" type="text" placeholder="Friend Telegram ID" class="input-field">
                    <button onclick="addTeamMember()" class="btn-gradient px-4 rounded-lg">Add</button>
                </div>
            </div>
            <div id="team-list" class="space-y-2"></div>
        </div>

        <!-- SEND BALANCE PAGE -->
        <div id="send-page" class="sub-page space-y-4">
            <div class="flex items-center gap-2">
                <button onclick="navigateTo('profile-page')" class="p-2 bg-white rounded-full"><i data-lucide="arrow-left"></i></button>
                <h2 class="font-bold">Transfer Balance</h2>
            </div>
            <div class="card-bg p-4 rounded-xl space-y-3">
                <p class="text-xs text-red-500 bg-red-50 p-2 rounded">5% Fee applicable on transfer.</p>
                <input id="send-to-id" type="text" placeholder="Recipient ID" class="input-field">
                <input id="send-amt" type="number" placeholder="Amount" class="input-field">
                <button onclick="executeSendBalance()" class="btn-gradient w-full py-3 rounded-lg">Transfer Now</button>
            </div>
        </div>

        <!-- ADMIN PAGE -->
        <div id="admin-page" class="sub-page space-y-6">
            <h2 class="text-xl font-bold text-center text-red-600">Admin Panel</h2>
            
            <!-- Earn Request Review -->
            <div class="space-y-3">
                <h3 class="font-bold border-b pb-1">Pending Earn Requests</h3>
                <div id="admin-earn-list" class="space-y-2 text-sm">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- Add Mails -->
            <div class="card-bg p-4 rounded-xl space-y-3 border-t-4 border-blue-500">
                <h3 class="font-bold">Add Stock</h3>
                <select id="admin-mail-type" class="input-field"></select>
                <textarea id="admin-mail-data" rows="4" class="input-field" placeholder="email/password/recovery..."></textarea>
                <button onclick="adminAddMails()" class="bg-blue-600 text-white w-full py-2 rounded">Add Mails</button>
            </div>
        </div>

    </main>

    <!-- Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="navigateTo('home-page')" id="nav-home">
            <i data-lucide="home" class="w-5 h-5"></i><span>HOME</span>
        </div>
        <div class="nav-item" onclick="navigateTo('earn-page')" id="nav-earn">
            <i data-lucide="rocket" class="w-5 h-5"></i><span>EARN</span>
        </div>
        <div class="nav-item" onclick="navigateTo('buy-page')" id="nav-buy">
            <i data-lucide="shopping-cart" class="w-5 h-5"></i><span>BUY</span>
        </div>
        <div class="nav-item" onclick="navigateTo('profile-page')" id="nav-profile">
            <i data-lucide="user" class="w-5 h-5"></i><span>PROFILE</span>
        </div>
        <div class="nav-item hidden" onclick="navigateTo('admin-page')" id="nav-admin">
            <i data-lucide="shield" class="w-5 h-5"></i><span>ADMIN</span>
        </div>
    </nav>

    <!-- Modals -->
    
    <!-- Notification Modal -->
    <div id="notif-modal" class="fixed inset-0 bg-black/50 z-[60] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-xl w-full max-w-sm max-h-[80vh] flex flex-col shadow-2xl">
            <div class="p-4 border-b flex justify-between items-center bg-gray-50 rounded-t-xl">
                <h3 class="font-bold">Notifications</h3>
                <button onclick="closeModal('notif-modal')"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div id="notif-list" class="p-4 overflow-y-auto space-y-2 flex-1"></div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alert-modal" class="fixed inset-0 bg-black/50 z-[70] hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 max-w-xs w-full text-center shadow-xl">
            <p id="alert-text" class="mb-4 text-gray-800 font-medium"></p>
            <button onclick="closeModal('alert-modal')" class="bg-blue-600 text-white px-6 py-2 rounded-lg w-full">OK</button>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="fixed inset-0 bg-black/50 z-[60] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-xl p-6 w-full max-w-sm shadow-xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-lg">Help & Guide</h3>
                <button onclick="closeModal('help-modal')"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div class="space-y-3 text-sm text-gray-700">
                <p><strong>üí∞ ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ:</strong> Earn ‡¶™‡ßá‡¶ú‡ßá ‡¶Ø‡¶æ‡¶®, Naval Coin ‡¶¨‡¶æ Instagram ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶ï‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡ßÅ‡¶´ ‡¶¶‡¶ø‡¶®‡•§ Manual Earn ‡¶∂‡ßÄ‡¶ò‡ßç‡¶∞‡¶á ‡¶Ü‡¶∏‡¶¨‡ßá‡•§</p>
                <p><strong>üì• ‡¶°‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü:</strong> '+' ‡¶Ü‡¶á‡¶ï‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá TrxID ‡¶¶‡¶ø‡¶®‡•§</p>
                <p><strong>üì§ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞:</strong> ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡ßß‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶π‡¶≤‡ßá ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂/‡¶®‡¶ó‡¶¶‡ßá ‡¶®‡¶ø‡¶®‡•§</p>
            </div>
            <button onclick="closeModal('help-modal')" class="mt-5 bg-gray-100 w-full py-2 rounded text-gray-600 font-bold">Close</button>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="fixed inset-0 bg-black/50 z-[70] hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 max-w-xs w-full text-center shadow-xl">
            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto text-green-600 mb-3">
                <i data-lucide="check" class="w-8 h-8"></i>
            </div>
            <h3 class="font-bold text-lg">Successful!</h3>
            <div id="success-content" class="text-left bg-gray-50 p-3 rounded my-3 text-xs font-mono break-all"></div>
            <button onclick="closeModal('success-modal')" class="bg-green-600 text-white px-6 py-2 rounded-lg w-full">OK</button>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script type="module">
        // --- CONFIGURATION ---
        const ADMIN_UID = "6954647230";
        const firebaseConfig = {
            apiKey: "AIzaSyCoCy08FL_sHHdA0f2cJg0BaF-iYAhFuk0",
            authDomain: "mail-store-4692b.firebaseapp.com",
            databaseURL: "https://mail-store-4692b-default-rtdb.firebaseio.com",
            projectId: "mail-store-4692b",
            storageBucket: "mail-store-4692b.firebasestorage.app",
            messagingSenderId: "264936867411",
            appId: "1:264936867411:web:5933919e5bafae617968a6"
        };

        // --- FIREBASE IMPORTS ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, collection, addDoc, serverTimestamp, query, where, getDocs, orderBy, limit, runTransaction, writeBatch, updateDoc, Timestamp, onSnapshot, arrayUnion, arrayRemove, increment } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- GLOBAL STATE ---
        let user = null;   // Telegram User Object
        let dbUser = null; // Firestore User Data
        let appConfig = {};

        // --- INITIALIZATION ---
        window.onload = async () => {
            try {
                if (window.Telegram.WebApp) {
                    window.Telegram.WebApp.ready();
                    window.Telegram.WebApp.expand();
                    user = window.Telegram.WebApp.initDataUnsafe.user;
                }
            } catch (e) { console.log("Telegram not detected"); }

            // Fallback for testing if not in Telegram (Remove in production if strict)
            if (!user) {
                // alert("Telegram User Not Found! Simulating for test."); 
                // user = { id: 12345678, first_name: "Test", last_name: "User", username: "tester" };
            }

            if (!user) {
                document.getElementById('loader').innerHTML = "<p class='text-red-500'>Please open in Telegram</p>";
                return;
            }

            await initUserSession();
            setupBanner();
            lucide.createIcons();
            
            // Hide Loader
            document.getElementById('loader').style.display = 'none';
        };

        async function initUserSession() {
            const uid = String(user.id);
            const userRef = doc(db, "users", uid);
            const snap = await getDoc(userRef);

            if (snap.exists()) {
                dbUser = snap.data();
                // Update info if changed
                updateDoc(userRef, { 
                    name: `${user.first_name} ${user.last_name || ''}`,
                    username: user.username || '',
                    lastSeen: serverTimestamp()
                });
            } else {
                // Create new user
                dbUser = {
                    tgChatId: uid,
                    name: `${user.first_name} ${user.last_name || ''}`,
                    username: user.username || '',
                    balance: 0,
                    createdAt: serverTimestamp()
                };
                await setDoc(userRef, dbUser);
            }

            // Load Config
            const confSnap = await getDoc(doc(db, "config", "main"));
            appConfig = confSnap.exists() ? confSnap.data() : { mails: [] };

            // UI Updates
            updateHeaderUI();
            checkAdmin();
            listenForNotifications();
            
            // Default Page
            navigateTo('home-page');
        }

        function updateHeaderUI() {
            document.getElementById('header-name').innerText = dbUser.name.split(' ')[0];
            document.getElementById('header-balance').innerText = dbUser.balance.toFixed(2);
            document.getElementById('home-balance-display').innerText = `‡ß≥${dbUser.balance.toFixed(2)}`;

            const pic = document.getElementById('header-pic');
            const initials = document.getElementById('header-initials');
            
            if (user.photo_url) {
                pic.src = user.photo_url;
                pic.classList.remove('hidden');
            } else {
                initials.innerText = dbUser.name.charAt(0).toUpperCase();
                initials.classList.remove('hidden');
            }

            // Profile Page Pop
            document.getElementById('p-name').innerText = dbUser.name;
            document.getElementById('p-id').innerText = `ID: ${dbUser.tgChatId}`;
            if(user.photo_url) {
                document.getElementById('p-pic').src = user.photo_url;
                document.getElementById('p-pic').classList.remove('hidden');
            } else {
                document.getElementById('p-initials').innerText = dbUser.name.charAt(0).toUpperCase();
                document.getElementById('p-initials').classList.remove('hidden');
            }
        }

        function checkAdmin() {
            if(String(user.id) === ADMIN_UID) {
                document.getElementById('nav-admin').classList.remove('hidden');
            }
        }

        // --- NAVIGATION ---
        window.navigateTo = async (pageId) => {
            // Hide all sub-pages
            document.querySelectorAll('.sub-page').forEach(el => el.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');

            // Nav styling
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            
            // Map pages to nav items
            const map = {
                'home-page': 'nav-home',
                'earn-page': 'nav-earn', 'naval-page': 'nav-earn', 'insta-page': 'nav-earn',
                'buy-page': 'nav-buy',
                'profile-page': 'nav-profile', 'link-team-page': 'nav-profile', 'send-page': 'nav-profile',
                'pay-page': 'nav-home', 'withdraw-page': 'nav-home', // Linked to header actions but conceptually home-ish
                'admin-page': 'nav-admin'
            };
            if(map[pageId]) document.getElementById(map[pageId]).classList.add('active');

            // Dynamic Loaders
            if(pageId === 'buy-page') loadProducts();
            if(pageId === 'pay-page') loadDeposits();
            if(pageId === 'withdraw-page') loadWithdrawals();
            if(pageId === 'admin-page') { populateAdminMails(); loadAdminEarnRequests(); }
            if(pageId === 'link-team-page') loadTeam();
            
            lucide.createIcons();
        }

        // --- EARN LOGIC ---
        window.handleManualEarn = () => {
            showAlert("‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶è‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú ‡¶ö‡¶≤‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶¶‡¶ø‡¶® ‡¶™‡¶∞ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá ‡¶á‡¶®‡¶∂‡¶æ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π");
        }

        window.submitEarnRequest = async (type, amtId, proofId) => {
            const info = document.getElementById(amtId).value;
            const proof = document.getElementById(proofId).value;

            if(!info || !proof) return showAlert("Please fill all fields.");

            showLoader(true);
            try {
                await addDoc(collection(db, "earn_requests"), {
                    userId: dbUser.tgChatId,
                    userName: dbUser.name,
                    taskType: type,
                    info: info, // Amount or Task Name
                    proof: proof,
                    status: "pending",
                    requestedAt: serverTimestamp()
                });
                showAlert("Request Submitted Successfully!");
                document.getElementById(amtId).value = "";
                document.getElementById(proofId).value = "";
                navigateTo('earn-page');
            } catch(e) { showAlert("Error: " + e.message); }
            showLoader(false);
        }

        // --- ADMIN LOGIC ---
        async function loadAdminEarnRequests() {
            const container = document.getElementById('admin-earn-list');
            container.innerHTML = "Loading...";
            
            const q = query(collection(db, "earn_requests"), where("status", "==", "pending"), orderBy("requestedAt", "desc"));
            const snap = await getDocs(q);

            if(snap.empty) { container.innerHTML = "No pending requests."; return; }

            container.innerHTML = snap.docs.map(d => {
                const data = d.data();
                return `
                <div class="bg-white border p-3 rounded shadow-sm">
                    <div class="flex justify-between font-bold">
                        <span>${data.taskType}</span>
                        <span class="text-xs text-gray-500">${data.userName}</span>
                    </div>
                    <p class="text-gray-700 mt-1">Info: ${data.info}</p>
                    <p class="text-xs text-gray-500 bg-gray-100 p-1 rounded mt-1 truncate">${data.proof}</p>
                    <div class="flex gap-2 mt-2">
                        <button onclick="approveEarn('${d.id}', '${data.userId}')" class="bg-green-500 text-white text-xs px-3 py-1 rounded">Approve</button>
                        <button onclick="rejectEarn('${d.id}')" class="bg-red-500 text-white text-xs px-3 py-1 rounded">Reject</button>
                    </div>
                </div>`;
            }).join('');
        }
        // Expose to window for inline onclick
        window.approveEarn = async (reqId, userId) => {
            const reward = prompt("Enter Reward Amount (BDT):", "0");
            if(reward === null) return;
            const amt = parseFloat(reward);
            
            showLoader(true);
            try {
                await runTransaction(db, async (t) => {
                    const uRef = doc(db, "users", userId);
                    const rRef = doc(db, "earn_requests", reqId);
                    
                    // Add Balance
                    t.update(uRef, { balance: increment(amt) });
                    // Update Request
                    t.update(rRef, { status: 'approved', reward: amt, processedAt: serverTimestamp() });
                    // Send Notification
                    const notifRef = doc(collection(db, "notifications"));
                    t.set(notifRef, {
                        recipientId: userId,
                        title: "Task Approved",
                        message: `You earned ‡ß≥${amt} for your task.`,
                        createdAt: serverTimestamp()
                    });
                });
                loadAdminEarnRequests();
                showAlert("Approved and Balance Added.");
            } catch(e) { showAlert("Error: " + e.message); }
            showLoader(false);
        }

        window.rejectEarn = async (reqId) => {
            if(!confirm("Reject this request?")) return;
            await updateDoc(doc(db, "earn_requests", reqId), { status: 'rejected' });
            loadAdminEarnRequests();
        }

        window.adminAddMails = async () => {
            const type = document.getElementById('admin-mail-type').value;
            const data = document.getElementById('admin-mail-data').value;
            if(!type || !data) return;

            const batch = writeBatch(db);
            const lines = data.split('\n');
            let count = 0;

            lines.forEach(line => {
                if(line.includes('/')) {
                    const [email, password] = line.split('/');
                    const newRef = doc(collection(db, type));
                    batch.set(newRef, { email, password, isSold: false, createdAt: serverTimestamp() });
                    count++;
                }
            });

            if(count > 0) {
                await batch.commit();
                showAlert(`${count} Mails Added.`);
                document.getElementById('admin-mail-data').value = "";
            }
        }

        function populateAdminMails() {
             const sel = document.getElementById('admin-mail-type');
             sel.innerHTML = (appConfig.mails || []).map(m => `<option value="${m.stockKey}">${m.type}</option>`).join('');
        }

        // --- DEPOSIT & WITHDRAW ---
        window.submitDeposit = async () => {
            const m = document.getElementById('dep-method').value;
            const a = parseFloat(document.getElementById('dep-amount').value);
            const n = document.getElementById('dep-number').value;
            const t = document.getElementById('dep-trx').value;

            if(!m || !a || !n || !t) return showAlert("Fill all fields");

            showLoader(true);
            try {
                await addDoc(collection(db, "deposits"), {
                    userId: dbUser.tgChatId, userName: dbUser.name,
                    method: m, amount: a, senderNumber: n, transactionId: t,
                    status: 'pending', requestedAt: serverTimestamp()
                });
                showAlert("Deposit Requested.");
                loadDeposits();
                document.getElementById('dep-trx').value = "";
            } catch(e) { showAlert(e.message); }
            showLoader(false);
        }

        window.submitWithdraw = async () => {
            const m = document.getElementById('with-method').value;
            const n = document.getElementById('with-number').value;
            const a = parseFloat(document.getElementById('with-amount').value);

            if(a < 100) return showAlert("Minimum 100 BDT");
            if(dbUser.balance < a) return showAlert("Insufficient Balance");

            showLoader(true);
            try {
                await runTransaction(db, async (t) => {
                    const uRef = doc(db, "users", dbUser.tgChatId);
                    const uSnap = await t.get(uRef);
                    if(uSnap.data().balance < a) throw "Low Balance";

                    t.update(uRef, { balance: increment(-a) });
                    const wRef = doc(collection(db, "withdrawals"));
                    t.set(wRef, {
                        userId: dbUser.tgChatId, userName: dbUser.name,
                        method: m, number: n, amount: a,
                        status: 'pending', requestedAt: serverTimestamp()
                    });
                });
                dbUser.balance -= a; updateHeaderUI();
                showAlert("Withdrawal Requested.");
                loadWithdrawals();
            } catch(e) { showAlert(e.message || e); }
            showLoader(false);
        }

        async function loadDeposits() {
            const list = document.getElementById('deposit-history');
            const q = query(collection(db, "deposits"), where("userId", "==", dbUser.tgChatId), orderBy("requestedAt", "desc"), limit(5));
            const s = await getDocs(q);
            list.innerHTML = s.empty ? "<p class='text-xs text-center text-gray-400'>No History</p>" : s.docs.map(d => {
                const i = d.data();
                return `<div class="bg-white p-2 rounded border flex justify-between text-xs"><span>${i.method}</span><span class="${i.status=='approved'?'text-green-600':'text-yellow-600'}">${i.amount} (${i.status})</span></div>`;
            }).join('');
        }

        async function loadWithdrawals() {
            const list = document.getElementById('withdraw-history');
            const q = query(collection(db, "withdrawals"), where("userId", "==", dbUser.tgChatId), orderBy("requestedAt", "desc"), limit(5));
            const s = await getDocs(q);
            list.innerHTML = s.empty ? "<p class='text-xs text-center text-gray-400'>No History</p>" : s.docs.map(d => {
                const i = d.data();
                return `<div class="bg-white p-2 rounded border flex justify-between text-xs"><span>${i.method}</span><span class="${i.status=='approved'?'text-green-600':'text-yellow-600'}">${i.amount} (${i.status})</span></div>`;
            }).join('');
        }

        // --- BUY SYSTEM ---
        async function loadProducts() {
            const container = document.getElementById('products-container');
            container.innerHTML = "<p class='text-center text-gray-500'>Loading...</p>";

            // Filter OTP mails
            const mails = (appConfig.mails || []).filter(m => m.category === 'otp');

            // Get Stock Counts
            const stockPromises = mails.map(m => 
                getDocs(query(collection(db, m.stockKey), where("isSold", "==", false), limit(1)))
                // Ideally use getCountFromServer, but checking existence is cheaper for 'In Stock' logic if specific count not needed, 
                // but let's imply count for better UX if possible, or just "Available"
            );
            
            // Simplified: Just check if at least one exists
            let html = "";
            for(let i=0; i<mails.length; i++) {
                const m = mails[i];
                // Checking actual count might be slow for many items, let's just check availability
                // For production, use a separate 'stock_counts' document updated by cloud functions
                html += `
                <div class="card-bg p-4 rounded-xl flex justify-between items-center bg-white">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center text-blue-600 font-bold text-lg">
                            ${m.type.charAt(0)}
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800">${m.type}</h3>
                            <p class="text-xs text-gray-500">OTP / Login</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-blue-600">‡ß≥${m.priceBdt}</p>
                        <button onclick="buyMail('${m.type}', ${m.priceBdt}, '${m.stockKey}')" class="bg-blue-600 text-white text-xs px-4 py-1.5 rounded-full mt-1">Buy</button>
                    </div>
                </div>`;
            }
            container.innerHTML = html || "<p class='text-center mt-5'>No Products Available</p>";
            loadPurchases();
        }

        window.buyMail = async (type, price, key) => {
            if(!confirm(`Purchase ${type} for ‡ß≥${price}?`)) return;
            
            showLoader(true);
            try {
                await runTransaction(db, async (t) => {
                    const uRef = doc(db, "users", dbUser.tgChatId);
                    const uSnap = await t.get(uRef);
                    
                    // 1. Check Balance
                    if(uSnap.data().balance < price) throw "Insufficient Balance";
                    
                    // 2. Check Stock
                    const q = query(collection(db, key), where("isSold", "==", false), limit(1));
                    const stockSnap = await getDocs(q);
                    if(stockSnap.empty) throw "Out of Stock";
                    const item = stockSnap.docs[0];
                    
                    // 3. Execute
                    t.update(uRef, { balance: increment(-price) });
                    t.update(item.ref, { isSold: true, soldTo: dbUser.tgChatId, soldAt: serverTimestamp() });
                    
                    const pRef = doc(collection(db, "mail_purchases"));
                    t.set(pRef, {
                        userId: dbUser.tgChatId,
                        mailType: type,
                        cost: price,
                        mail: item.data().email,
                        password: item.data().password,
                        purchasedAt: serverTimestamp()
                    });

                    // Show Success
                    showSuccessModal(item.data().email, item.data().password);
                });
                dbUser.balance -= price; updateHeaderUI();
            } catch(e) { showAlert(e.message || e); }
            showLoader(false);
        }

        async function loadPurchases() {
            const div = document.getElementById('purchase-history-list');
            const q = query(collection(db, "mail_purchases"), where("userId", "==", dbUser.tgChatId), orderBy("purchasedAt", "desc"), limit(10));
            const s = await getDocs(q);
            div.innerHTML = s.docs.map(d => {
                const i = d.data();
                return `<div class="bg-gray-100 p-2 rounded border">
                    <div class="flex justify-between font-bold text-xs"><span>${i.mailType}</span><span>‡ß≥${i.cost}</span></div>
                    <div class="bg-white p-1 mt-1 rounded font-mono select-all">${i.mail}</div>
                    <div class="bg-white p-1 mt-1 rounded font-mono select-all">${i.password}</div>
                </div>`
            }).join('');
        }

        // --- TEAM & TRANSFER ---
        window.addTeamMember = async () => {
            const fid = document.getElementById('team-friend-id').value;
            if(!fid) return;
            try {
                const fRef = doc(db, "users", fid);
                const fSnap = await getDoc(fRef);
                if(!fSnap.exists()) return showAlert("User not found");
                if(fSnap.data().linkedBy) return showAlert("Already in a team");

                await updateDoc(doc(db, "users", dbUser.tgChatId), { linkedUsers: arrayUnion(fid) });
                await updateDoc(fRef, { linkedBy: dbUser.tgChatId });
                showAlert("Friend Added!");
                loadTeam();
            } catch(e) { showAlert("Error adding friend"); }
        }

        async function loadTeam() {
            const div = document.getElementById('team-list');
            const snap = await getDoc(doc(db, "users", dbUser.tgChatId));
            const list = snap.data().linkedUsers || [];
            div.innerHTML = list.length ? list.map(id => `<div class="bg-white p-2 rounded border text-sm">${id}</div>`).join('') : "<p class='text-xs text-gray-400'>No members</p>";
        }

        window.executeSendBalance = async () => {
            const to = document.getElementById('send-to-id').value;
            const amt = parseFloat(document.getElementById('send-amt').value);
            if(!to || !amt || amt < 20) return showAlert("Min 20 BDT");
            const total = amt * 1.05;

            if(dbUser.balance < total) return showAlert("Insufficient Balance (incl 5% fee)");

            showLoader(true);
            try {
                await runTransaction(db, async(t)=>{
                    const sender = doc(db, "users", dbUser.tgChatId);
                    const rec = doc(db, "users", to);
                    const rSnap = await t.get(rec);
                    if(!rSnap.exists()) throw "Receiver ID Invalid";

                    t.update(sender, { balance: increment(-total) });
                    t.update(rec, { balance: increment(amt) });
                    t.set(doc(collection(db, "transfers")), { from: dbUser.tgChatId, to: to, amount: amt, timestamp: serverTimestamp() });
                });
                dbUser.balance -= total; updateHeaderUI();
                showAlert("Transfer Successful!");
                document.getElementById('send-amt').value = "";
            } catch(e){ showAlert(e.message||e); }
            showLoader(false);
        }

        // --- NOTIFICATIONS & MODALS ---
        window.openNotifications = async () => {
            document.getElementById('notif-modal').classList.remove('hidden');
            document.getElementById('notif-badge').classList.add('hidden'); // Clear badge
            const list = document.getElementById('notif-list');
            list.innerHTML = "Loading...";
            
            const q = query(collection(db, "notifications"), where("recipientId", "in", [dbUser.tgChatId, "all"]), orderBy("createdAt", "desc"), limit(20));
            const snap = await getDocs(q);
            
            list.innerHTML = snap.empty ? "<p class='text-center text-gray-500'>No notifications</p>" : snap.docs.map(d => {
                const n = d.data();
                return `<div class="bg-blue-50 p-3 rounded-lg border border-blue-100">
                    <h4 class="font-bold text-sm text-blue-800">${n.title}</h4>
                    <p class="text-xs text-gray-600 mt-1">${n.message}</p>
                </div>`;
            }).join('');
        }
        
        function listenForNotifications() {
            const q = query(collection(db, "notifications"), where("recipientId", "==", dbUser.tgChatId), where("createdAt", ">", Timestamp.now()));
            onSnapshot(q, (snap) => {
                if(!snap.empty) document.getElementById('notif-badge').classList.remove('hidden');
            });
        }

        // --- UTILS ---
        window.openSupport = () => window.Telegram.WebApp.openTelegramLink("https://t.me/EXPERTearn_team");
        window.openHelpModal = () => document.getElementById('help-modal').classList.remove('hidden');
        window.closeModal = (id) => document.getElementById(id).classList.add('hidden');
        window.showAlert = (msg) => {
            document.getElementById('alert-text').innerText = msg;
            document.getElementById('alert-modal').classList.remove('hidden');
        }
        window.showSuccessModal = (email, pass) => {
            document.getElementById('success-content').innerHTML = `
                <p class="mb-1"><strong>Email:</strong> ${email}</p>
                <p><strong>Pass:</strong> ${pass}</p>
            `;
            document.getElementById('success-modal').classList.remove('hidden');
        }
        window.copyText = (txt) => {
            navigator.clipboard.writeText(txt);
            showAlert("Copied to clipboard!");
        }
        const showLoader = (show) => document.getElementById('loader').style.display = show ? 'flex' : 'none';

        function setupBanner() {
            const slider = document.getElementById('banner-slider');
            const count = 3; 
            let idx = 0;
            setInterval(() => {
                idx = (idx + 1) % count;
                slider.style.transform = `translateX(-${idx * 100}%)`;
            }, 3000);
        }
    </script>
</body>
</html>
